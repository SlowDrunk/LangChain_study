# Faiss å‘é‡æ•°æ®åº“è®¾ç½®æŒ‡å—

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨ Node.js ç¯å¢ƒä¸­ä½¿ç”¨ Faiss ä½œä¸º LangChain çš„å‘é‡å­˜å‚¨ã€‚

## ä»€ä¹ˆæ˜¯ Faissï¼Ÿ

Faiss (Facebook AI Similarity Search) æ˜¯ Facebook å¼€æºçš„é«˜æ€§èƒ½å‘é‡ç›¸ä¼¼æ€§æœç´¢åº“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- âœ… **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–çš„å‘é‡æœç´¢ç®—æ³•ï¼Œæœç´¢é€Ÿåº¦å¿«
- âœ… **æœ¬åœ°è¿è¡Œ**ï¼šç›´æ¥åœ¨ Node.js è¿›ç¨‹ä¸­è¿è¡Œï¼Œæ— éœ€é¢å¤–æœåŠ¡
- âœ… **æŒä¹…åŒ–å­˜å‚¨**ï¼šå¯ä»¥ä¿å­˜ç´¢å¼•åˆ°ç£ç›˜ï¼Œä¸‹æ¬¡ç›´æ¥åŠ è½½
- âœ… **æ˜“äºé›†æˆ**ï¼šä¸ LangChain å®Œç¾é›†æˆ
- âœ… **ç”Ÿäº§çº§**ï¼šè¢«å¹¿æ³›ä½¿ç”¨ï¼Œç¨³å®šå¯é 

## å®‰è£…æ­¥éª¤

### 1. å®‰è£… npm ä¾èµ–

```bash
npm install faiss-node @langchain/community
```

è¿™ä¼šåœ¨ `package.json` ä¸­æ·»åŠ ï¼š
- `faiss-node` - Faiss çš„ Node.js ç»‘å®š
- `@langchain/community` - LangChain ç¤¾åŒºé›†æˆï¼ˆåŒ…å« Faiss æ”¯æŒï¼‰

### 2. éªŒè¯å®‰è£…

å®‰è£…å®Œæˆåï¼Œå¯ä»¥è¿è¡Œç¤ºä¾‹ç¨‹åºæµ‹è¯•ï¼š

```bash
node src/examples/4.4-vector-store.js
```

## ä½¿ç”¨æ–¹å¼

### åŸºæœ¬ä½¿ç”¨

```javascript
import { FaissStore } from "@langchain/community/vectorstores/faiss";
import { OpenAIEmbeddings } from "@langchain/openai";

// 1. åˆ›å»ºåµŒå…¥æ¨¡å‹
const embeddings = new OpenAIEmbeddings({
  openAIApiKey: process.env.OPENAI_API_KEY
});

// 2. ä»æ–‡æ¡£åˆ›å»ºå‘é‡å­˜å‚¨
const documents = [...]; // ä½ çš„æ–‡æ¡£æ•°ç»„
const vectorStore = await FaissStore.fromDocuments(
  documents,
  embeddings
);

// 3. è¿›è¡Œç›¸ä¼¼æ€§æœç´¢
const results = await vectorStore.similaritySearch("æŸ¥è¯¢æ–‡æœ¬", 3);

// 4. ä¿å­˜ç´¢å¼•åˆ°ç£ç›˜ï¼ˆå¯é€‰ï¼‰
await vectorStore.save("./faiss_index");

// 5. ä»ç£ç›˜åŠ è½½ç´¢å¼•
const loadedStore = await FaissStore.load("./faiss_index", embeddings);
```

## åœ¨ç¤ºä¾‹ç¨‹åºä¸­çš„ä½¿ç”¨

### ç¤ºä¾‹ 4.4: å‘é‡å­˜å‚¨

æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Faiss åˆ›å»ºå‘é‡å­˜å‚¨å¹¶è¿›è¡Œæœç´¢ã€‚

**ç‰¹ç‚¹**:
- è‡ªåŠ¨ä¿å­˜å‘é‡ç´¢å¼•åˆ° `faiss_index` ç›®å½•
- æ¼”ç¤ºå¦‚ä½•ä»ç£ç›˜åŠ è½½å·²ä¿å­˜çš„ç´¢å¼•
- å±•ç¤ºç›¸ä¼¼æ€§æœç´¢å’Œæ£€ç´¢å™¨çš„ä½¿ç”¨

**è¿è¡Œ**:
```bash
node src/examples/4.4-vector-store.js
```

### ç¤ºä¾‹ 4.5: RAG æ£€ç´¢ç”Ÿæˆ

ä½¿ç”¨ Faiss ä½œä¸ºå‘é‡å­˜å‚¨å®ç° RAGã€‚

**ç‰¹ç‚¹**:
- è‡ªåŠ¨æ£€æŸ¥æ˜¯å¦å­˜åœ¨å·²ä¿å­˜çš„ç´¢å¼•
- å¦‚æœå­˜åœ¨åˆ™ç›´æ¥åŠ è½½ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºå¹¶ä¿å­˜
- å°† Faiss æ£€ç´¢ç»“æœä½œä¸ºä¸Šä¸‹æ–‡æä¾›ç»™æ¨¡å‹

**è¿è¡Œ**:
```bash
node src/examples/4.5-rag.js
```

### ç¤ºä¾‹ 4.6: Agent

åœ¨ Agent å·¥å…·ä¸­ä½¿ç”¨ Faiss è¿›è¡Œå‘é‡æ£€ç´¢ã€‚

**ç‰¹ç‚¹**:
- Agent å·¥å…·ä½¿ç”¨ Faiss æ£€ç´¢ç›¸å…³ä¿¡æ¯
- è‡ªåŠ¨ç®¡ç†å‘é‡ç´¢å¼•çš„åˆ›å»ºå’ŒåŠ è½½
- å±•ç¤ºå¦‚ä½•åœ¨å¤æ‚ç³»ç»Ÿä¸­é›†æˆå‘é‡å­˜å‚¨

**è¿è¡Œ**:
```bash
node src/examples/4.6-agent.js
```

## ç´¢å¼•æ–‡ä»¶ä½ç½®

ç¤ºä¾‹ç¨‹åºä¼šå°†å‘é‡ç´¢å¼•ä¿å­˜åˆ°ä»¥ä¸‹ä½ç½®ï¼š

- **ç¤ºä¾‹ 4.4**: `faiss_index/`
- **ç¤ºä¾‹ 4.5**: `faiss_index_rag/`
- **ç¤ºä¾‹ 4.6**: `faiss_index_agent/`

è¿™äº›ç›®å½•ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºã€‚å¦‚æœå·²å­˜åœ¨ç´¢å¼•æ–‡ä»¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨åŠ è½½ï¼Œæ— éœ€é‡æ–°åˆ›å»ºã€‚

## ä¼˜åŠ¿å¯¹æ¯”

### Faiss vs ChromaDB

| ç‰¹æ€§ | Faiss | ChromaDB |
|------|-------|----------|
| **è¿è¡Œæ–¹å¼** | æœ¬åœ°åº“ï¼ŒNode.js è¿›ç¨‹å†… | ç‹¬ç«‹æœåŠ¡ï¼Œéœ€è¦å¯åŠ¨ |
| **å®‰è£…å¤æ‚åº¦** | ç®€å•ï¼ˆnpm installï¼‰ | éœ€è¦ Python/Docker |
| **æ€§èƒ½** | éå¸¸é«˜ | é«˜ |
| **æŒä¹…åŒ–** | ä¿å­˜åˆ°ç£ç›˜ | æ•°æ®åº“å­˜å‚¨ |
| **é€‚ç”¨åœºæ™¯** | æœ¬åœ°åº”ç”¨ã€é«˜æ€§èƒ½éœ€æ±‚ | åˆ†å¸ƒå¼éƒ¨ç½²ã€å¤šè¯­è¨€æ”¯æŒ |

### ä½•æ—¶é€‰æ‹© Faissï¼Ÿ

âœ… **é€‚åˆä½¿ç”¨ Faiss çš„åœºæ™¯**:
- æœ¬åœ°åº”ç”¨å¼€å‘
- éœ€è¦é«˜æ€§èƒ½æœç´¢
- ä¸æƒ³è¿è¡Œé¢å¤–æœåŠ¡
- Node.js å•æœºåº”ç”¨

âŒ **ä¸é€‚åˆä½¿ç”¨ Faiss çš„åœºæ™¯**:
- éœ€è¦è·¨è¯­è¨€è®¿é—®ï¼ˆPythonã€Java ç­‰ï¼‰
- éœ€è¦åˆ†å¸ƒå¼éƒ¨ç½²
- éœ€è¦å¤šå®ä¾‹å…±äº«æ•°æ®
- éœ€è¦ RESTful API æ¥å£

## å¸¸è§é—®é¢˜

### Q1: å®‰è£… faiss-node å¤±è´¥

**åŸå› **: å¯èƒ½éœ€è¦ç¼–è¯‘åŸç”Ÿæ¨¡å—ï¼Œéœ€è¦ç³»ç»Ÿä¾èµ–

**è§£å†³**:
```bash
# macOS
xcode-select --install

# Ubuntu/Debian
sudo apt-get install build-essential

# ç„¶åé‡æ–°å®‰è£…
npm install faiss-node
```

### Q2: ç´¢å¼•æ–‡ä»¶å¾ˆå¤§

**åŸå› **: å‘é‡ç´¢å¼•åŒ…å«æ‰€æœ‰æ–‡æ¡£çš„å‘é‡è¡¨ç¤º

**è¯´æ˜**: è¿™æ˜¯æ­£å¸¸çš„ï¼Œç´¢å¼•æ–‡ä»¶å¤§å°å–å†³äºï¼š
- æ–‡æ¡£æ•°é‡
- å‘é‡ç»´åº¦ï¼ˆé€šå¸¸æ˜¯ 1536 æˆ– 3072ï¼‰
- ç´¢å¼•ç±»å‹

### Q3: å¦‚ä½•åˆ é™¤ç´¢å¼•é‡æ–°åˆ›å»ºï¼Ÿ

**è§£å†³**:
```bash
# åˆ é™¤ç´¢å¼•ç›®å½•
rm -rf faiss_index
rm -rf faiss_index_rag
rm -rf faiss_index_agent

# é‡æ–°è¿è¡Œç¤ºä¾‹ç¨‹åº
node src/examples/4.4-vector-store.js
```

### Q4: å¯ä»¥è‡ªå®šä¹‰ç´¢å¼•ä¿å­˜è·¯å¾„å—ï¼Ÿ

**å¯ä»¥**ï¼Œä¿®æ”¹ç¤ºä¾‹ä»£ç ä¸­çš„è·¯å¾„ï¼š

```javascript
const faissIndexPath = path.join(__dirname, "../../your_custom_path");
```

### Q5: æ”¯æŒå¢é‡æ·»åŠ æ–‡æ¡£å—ï¼Ÿ

**å¯ä»¥**ï¼ŒFaissStore æ”¯æŒæ·»åŠ æ–°æ–‡æ¡£ï¼š

```javascript
// æ·»åŠ æ–°æ–‡æ¡£
await vectorStore.addDocuments(newDocuments);

// é‡æ–°ä¿å­˜ç´¢å¼•
await vectorStore.save(faissIndexPath);
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ‰¹é‡å¤„ç†**: ä¸€æ¬¡æ€§æ·»åŠ å¤šä¸ªæ–‡æ¡£æ¯”é€ä¸ªæ·»åŠ æ•ˆç‡é«˜
2. **ç´¢å¼•ç±»å‹**: æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„ç´¢å¼•ç±»å‹ï¼ˆé»˜è®¤ä¸º L2 è·ç¦»ï¼‰
3. **å†…å­˜ç®¡ç†**: å¯¹äºå¤§å‹æ•°æ®é›†ï¼Œè€ƒè™‘åˆ†æ‰¹å¤„ç†
4. **ç¼“å­˜ç­–ç•¥**: å¯¹äºé¢‘ç¹æŸ¥è¯¢ï¼Œå¯ä»¥ä¿æŒå‘é‡å­˜å‚¨åœ¨å†…å­˜ä¸­

## ç›¸å…³èµ„æº

- [Faiss å®˜æ–¹æ–‡æ¡£](https://github.com/facebookresearch/faiss)
- [faiss-node GitHub](https://github.com/ewfian/faiss-node)
- [LangChain Faiss é›†æˆæ–‡æ¡£](https://js.langchain.com/docs/integrations/vectorstores/faiss)

## ä¸‹ä¸€æ­¥

è®¾ç½®å¥½ Faiss åï¼Œä½ å¯ä»¥ï¼š

1. âœ… è¿è¡Œç¤ºä¾‹ç¨‹åºæµ‹è¯•åŠŸèƒ½
2. âœ… äº†è§£å‘é‡å­˜å‚¨çš„å·¥ä½œåŸç†
3. âœ… æ¢ç´¢ RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ
4. âœ… åœ¨ Agent ä¸­é›†æˆå‘é‡å­˜å‚¨
5. âœ… ä¼˜åŒ–æœç´¢æ€§èƒ½å’Œå‡†ç¡®æ€§

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰

